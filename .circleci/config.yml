version: 2

defaults: &defaults 
  working_directory: /home/circleci/project
  docker:
    - image: circleci/node

jobs: 
  test:
    <<: *defaults 
    steps:  
      - checkout 
      - run: 
          name: Application Build 
          command: npm install 
      - run:
          name: Application test  
          command: npm test 
      
      - persist_to_workspace:
          root: /home/circleci/project
          paths: .        

workflows:
  version: 2
  oneapp-pkg:
    jobs:
      - test 
      - publish:
           requires:
             - test

